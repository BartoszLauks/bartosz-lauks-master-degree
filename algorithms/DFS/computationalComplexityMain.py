import resource
import signal
import sys
import tracemalloc

from userDFS import dfs


def time_exceeded(signo, frame):
    print(sys.argv[1], 'ERROR TIME OUT')
    sys.exit(1)


def set_max_runtime(seconds):
    soft, hard = resource.getrlimit(resource.RLIMIT_CPU)
    resource.setrlimit(resource.RLIMIT_CPU, (seconds, hard))
    signal.signal(signal.SIGXCPU, time_exceeded)


class Graph:
    def __init__(self):
        self.graph = {237: [450, 253], 344: [47, 709], 283: [345], 795: [504], 361: [104], 888: [268, 800],
                      522: [537, 349], 244: [150, 829, 535], 603: [324, 680, 795], 551: [100, 267], 238: [192],
                      168: [660, 595], 833: [107, 192, 625, 628], 492: [237, 670], 171: [396, 156], 636: [425],
                      547: [118], 476: [461, 695], 622: [530, 489], 328: [127, 409, 699, 888], 93: [814, 374],
                      829: [614, 864, 458], 207: [13, 603], 541: [270], 129: [20, 351, 647], 273: [613, 446, 407],
                      765: [717], 782: [619, 381], 49: [457], 879: [464, 155, 883], 867: [435, 495],
                      12: [644, 180, 607], 200: [831, 52, 776], 646: [424, 698, 203], 785: [561], 88: [842], 747: [811],
                      503: [547, 59], 205: [80], 579: [63, 719, 879], 436: [894, 676, 808], 47: [888], 94: [608, 137],
                      657: [261, 413, 6], 865: [819], 727: [236], 543: [656], 46: [836, 640, 1], 470: [687, 884, 173],
                      232: [364, 661], 458: [193], 134: [119, 434, 188, 7], 832: [264], 440: [759], 609: [722, 499],
                      163: [167, 322, 29, 863], 702: [696, 371, 854], 74: [392, 530], 353: [113, 29], 430: [175, 780],
                      201: [248, 547], 420: [713, 721, 521, 751], 159: [345, 390, 153], 900: [184], 834: [655, 730],
                      767: [228, 391], 897: [41], 0: [504, 468], 770: [550, 160, 162], 496: [884, 113], 325: [106, 231],
                      419: [301, 621], 386: [508], 574: [568, 111, 73], 266: [84, 640, 500], 208: [252], 15: [414, 344],
                      338: [584, 600], 508: [275, 638, 498], 397: [588, 196], 113: [513], 789: [337], 619: [642],
                      18: [518], 881: [618], 304: [403, 277, 683, 618], 876: [76, 254, 697], 647: [207], 836: [841],
                      197: [230, 412, 837], 89: [202, 251], 194: [419], 34: [402, 235, 843], 678: [146, 613, 505],
                      842: [17, 755, 405, 881], 369: [873], 233: [816, 185], 469: [348, 259], 486: [238],
                      67: [302, 96, 369], 446: [201, 477, 255], 314: [633, 573], 116: [603, 327], 825: [208],
                      653: [595, 292], 682: [809], 203: [636, 885, 799, 475], 617: [674, 210, 406], 337: [619],
                      813: [844], 158: [403, 201, 745], 50: [831], 576: [352], 187: [165, 614, 561], 529: [180],
                      77: [805, 2], 899: [869, 22], 803: [430], 851: [463], 209: [807], 451: [735], 138: [813],
                      845: [848, 897, 56], 697: [45, 776, 736], 360: [453], 160: [610, 251, 100], 184: [888],
                      895: [569, 576], 133: [224, 712], 64: [462], 127: [331, 709], 581: [734, 273], 52: [384],
                      61: [76, 349], 731: [855, 783], 504: [819, 585], 641: [560, 579, 69], 128: [319, 899],
                      732: [534, 486, 392], 341: [859], 309: [694, 117, 470, 261], 434: [296, 68], 783: [651],
                      229: [862, 623], 223: [618, 387], 245: [648], 6: [735, 508, 75], 721: [768, 511], 478: [599],
                      220: [781], 350: [116], 793: [465, 589, 627], 586: [296], 681: [6], 539: [606, 401],
                      801: [316, 717], 342: [112], 708: [838, 884, 205], 729: [233], 567: [324], 584: [836, 355],
                      648: [842], 630: [43, 322], 66: [421], 761: [767], 661: [701], 258: [598, 219], 651: [805],
                      287: [599, 589], 515: [75, 641], 595: [742, 537], 591: [401, 613, 456], 839: [363, 877, 28, 195],
                      289: [608, 438], 631: [486, 178], 744: [681], 382: [229], 110: [850], 890: [240, 189, 269],
                      674: [663], 820: [788, 438], 779: [517, 41], 635: [524], 480: [509], 475: [895, 552],
                      823: [229, 827], 810: [637, 387], 101: [876], 487: [494, 265, 602, 213], 570: [120, 681, 296],
                      528: [329, 640], 613: [624], 136: [180, 361, 579, 64], 575: [576, 745], 432: [829, 241],
                      448: [46, 540, 526, 460], 108: [170, 763], 59: [156, 607], 563: [715], 573: [533], 812: [687],
                      726: [89], 835: [836], 548: [460], 452: [28, 494, 305, 744], 559: [618, 466],
                      7: [435, 55, 779, 513], 692: [545], 36: [103, 577, 33], 411: [855], 534: [107],
                      20: [693, 852, 871, 65], 506: [273], 494: [837, 521], 491: [513], 696: [637, 743],
                      585: [178, 231, 136], 659: [658], 633: [186, 169], 746: [113, 380], 606: [704, 12], 605: [170],
                      564: [46, 149], 290: [202], 174: [248], 614: [102, 878], 248: [245, 240, 63], 474: [263],
                      889: [327], 417: [582], 577: [284, 131], 669: [664, 448], 58: [471], 4: [755], 78: [774],
                      471: [251], 780: [127], 57: [213, 438, 686], 231: [461, 702, 222], 398: [231], 422: [75],
                      826: [811], 210: [235, 630], 500: [63, 811, 512], 322: [758, 337], 505: [323, 218, 431],
                      276: [517, 572], 816: [661], 687: [751, 869], 96: [345], 319: [312], 80: [93], 247: [483],
                      740: [749, 202, 519], 639: [665], 884: [898], 132: [720], 104: [670, 601], 706: [685, 482],
                      216: [445], 773: [170, 150], 645: [371, 618], 424: [701, 80, 661], 877: [892, 244, 841],
                      115: [507, 340], 148: [392, 495], 179: [441, 15], 536: [523, 506], 105: [462, 818],
                      855: [189, 81], 214: [897], 587: [175], 255: [559], 741: [619], 893: [589, 681, 708], 553: [12],
                      366: [369], 364: [818], 891: [194], 10: [247], 35: [716], 848: [192], 330: [18],
                      306: [821, 746, 131], 598: [731], 68: [587], 655: [221], 672: [439], 660: [627], 642: [813],
                      768: [261, 552, 885], 495: [878], 707: [531], 177: [469, 732], 482: [573], 705: [316, 63],
                      151: [210], 295: [127], 560: [123, 861], 620: [353], 199: [56], 511: [256], 368: [569],
                      140: [369], 316: [514], 484: [126, 115], 157: [185, 416], 102: [445], 556: [448], 109: [366],
                      331: [207, 463, 37], 123: [842], 31: [483], 791: [216, 346, 76], 189: [244, 707], 775: [864],
                      444: [780], 621: [36], 898: [561], 459: [820], 27: [474], 652: [133], 355: [779],
                      137: [466, 641, 82], 479: [670, 622, 866, 403], 408: [745, 6], 410: [325], 802: [297, 726],
                      43: [620, 90], 367: [172, 438], 849: [417], 243: [621, 171], 558: [135], 800: [797, 278],
                      880: [560, 564], 501: [434], 632: [437, 556, 806], 213: [845], 465: [668], 296: [553], 119: [421],
                      333: [314, 441, 56], 428: [194], 230: [723], 518: [381, 850], 711: [282, 56], 445: [430, 287, 87],
                      405: [417, 886], 8: [721, 195], 743: [341, 15, 716], 792: [329], 90: [150, 149, 782], 372: [692],
                      755: [108], 853: [529], 798: [69], 125: [328], 271: [572], 533: [195, 83], 728: [52, 736],
                      236: [399], 472: [61], 607: [491, 900], 597: [777], 376: [285], 278: [160], 103: [394],
                      191: [289, 27], 392: [43], 786: [895], 449: [243], 429: [182, 110], 588: [132], 145: [543],
                      625: [384], 323: [222], 269: [247], 673: [99, 86], 340: [257, 788], 24: [545], 413: [678],
                      30: [816], 202: [530], 144: [516], 351: [430, 336, 607], 683: [186], 466: [277], 644: [261],
                      860: [577], 680: [472, 256], 754: [65], 11: [390, 482], 181: [18, 474], 637: [202, 134],
                      667: [468, 501], 766: [884, 523], 868: [4, 151], 63: [161, 571, 136], 664: [369, 611], 542: [229],
                      389: [635], 221: [461, 422], 756: [159], 16: [195], 379: [205], 193: [715, 115], 523: [817],
                      830: [486], 510: [779], 850: [200, 406], 873: [644, 595], 799: [315], 814: [138], 126: [435, 327],
                      44: [532], 147: [780, 900], 589: [281], 142: [54, 471, 658], 531: [900], 26: [471, 33],
                      215: [439], 348: [723], 468: [5], 118: [319], 426: [55, 211], 794: [878, 835], 167: [255],
                      401: [102], 544: [236], 599: [585], 357: [832], 124: [344], 498: [285], 82: [888], 162: [854],
                      246: [130, 95], 404: [281], 370: [712, 469], 260: [819, 65], 81: [455], 679: [229], 527: [230],
                      414: [5], 703: [153], 318: [364], 827: [13, 519], 748: [759], 56: [859], 601: [869], 294: [234],
                      854: [766], 241: [331], 54: [167], 327: [103], 532: [790], 514: [731], 723: [596, 881],
                      107: [879], 572: [441], 552: [116], 817: [200], 312: [246], 388: [380], 857: [159], 76: [788],
                      640: [783], 846: [354], 634: [57], 537: [408], 73: [156], 390: [3], 535: [271], 629: [796],
                      513: [893], 431: [412, 647], 717: [74], 315: [778, 377], 146: [456], 546: [28], 5: [811],
                      407: [796], 752: [370], 91: [620], 100: [710], 477: [199], 293: [432], 710: [293], 662: [580],
                      490: [252], 378: [866], 437: [823], 228: [760], 671: [39], 858: [384], 521: [432, 721],
                      875: [850], 14: [82], 837: [167, 763], 40: [668], 149: [778], 206: [753], 453: [717], 211: [454],
                      677: [548], 499: [446], 264: [497], 507: [360], 517: [844, 418], 381: [111, 558, 94], 299: [426],
                      265: [23], 198: [623], 824: [883, 571], 117: [522], 234: [863], 332: [697], 455: [582], 48: [737],
                      561: [538, 643], 261: [113], 790: [822], 493: [418], 663: [545], 776: [49], 326: [706],
                      435: [842], 363: [900], 856: [707], 334: [557], 161: [758], 165: [668], 69: [38], 896: [0],
                      362: [524], 804: [634], 894: [110, 541], 467: [388, 319], 336: [26], 725: [870], 259: [434],
                      774: [208], 656: [649], 714: [191], 489: [697], 2: [419], 742: [25], 460: [392], 365: [842, 687],
                      87: [797], 769: [728], 29: [34, 560], 874: [187], 718: [668], 624: [819], 352: [545], 51: [508],
                      311: [431], 578: [265], 627: [274], 70: [518], 722: [553], 356: [257], 878: [246], 473: [394],
                      525: [305], 488: [516]}


if __name__ == '__main__':
    if len(sys.argv) < 4:
        print(sys.argv[1], 'ERROR NO PARAMETERS IN THE CALL')
        sys.exit()
    set_max_runtime(int(sys.argv[2]))
    print(sys.argv[1], 'START COMPUTATIONAL COMPLEXITY TEST')
    PEEK_MEMORY = int(sys.argv[3])
    graph = Graph()
    tracemalloc.start()
    dfs(graph, 0)
    peekTracedMemory = int(tracemalloc.get_traced_memory()[1])
    tracemalloc.stop()

    print(sys.argv[1], 'PEEK MEMORY USAGE BY YOUR IMPLEMENTATION:', peekTracedMemory)
    if peekTracedMemory < (PEEK_MEMORY * 2):
        print(sys.argv[1], 'FINISH COMPUTATIONAL COMPLEXITY TEST')
    else:
        print(sys.argv[1], 'ERROR MEMORY LIMIT EXCEEDED')
